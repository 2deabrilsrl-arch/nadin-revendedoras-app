// Agregar estos campos al modelo Order existente en schema.prisma

model Order {
  id          String   @id @default(cuid())
  userId      String
  cliente     String
  telefono    String
  nota        String?
  descuento   Float    @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // ✅ NUEVO: Estados del pedido (logística)
  orderStatus String   @default("pending")
  // Valores: "pending" | "sent_to_nadin" | "received_nadin" | "sent_to_client" | "delivered"
  
  // ✅ NUEVO: Estados de pago
  paidToNadin    Boolean  @default(false)
  paidByClient   Boolean  @default(false)
  
  // ✅ NUEVO: Fechas de cambio de estado
  sentToNadinAt      DateTime?
  receivedNadinAt    DateTime?
  sentToClientAt     DateTime?
  deliveredAt        DateTime?
  paidToNadinAt      DateTime?
  paidByClientAt     DateTime?
  
  lineas      OrderLinea[]
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([createdAt])
}

model OrderLinea {
  id         Int    @id @default(autoincrement())
  orderId    String
  sku        String
  brand      String
  name       String
  talle      String
  color      String
  qty        Int
  mayorista  Float
  venta      Float

  order      Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@index([orderId])
}
